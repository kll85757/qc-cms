(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03d9c735"],{"618a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"相册名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("新增相册")])],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.albumList,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"ID",prop:"id",width:"80px",align:"center"}}),n("el-table-column",{attrs:{label:"相册名称",prop:"name","min-width":"150px"}}),n("el-table-column",{attrs:{label:"排序编号",prop:"sortNo",width:"150px",align:"center"}}),n("el-table-column",{attrs:{label:"描述",prop:"description","min-width":"150px"}}),n("el-table-column",{attrs:{label:"操作",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.confirmDelete(r)}}},[e._v("删除")]),n("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.viewAlbumImages(r)}}},[e._v("查看图片")])]}}])})],1),n("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.listQuery.pageNo,"page-sizes":[10,20,50,100],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"相册管理"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.currentAlbum,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"相册名称"}},[n("el-input",{model:{value:e.currentAlbum.name,callback:function(t){e.$set(e.currentAlbum,"name",t)},expression:"currentAlbum.name"}})],1),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{attrs:{type:"textarea",rows:"6"},model:{value:e.currentAlbum.description,callback:function(t){e.$set(e.currentAlbum,"description",t)},expression:"currentAlbum.description"}})],1),n("el-form-item",{attrs:{label:"排序编号"}},[n("el-input",{model:{value:e.currentAlbum.sortNo,callback:function(t){e.$set(e.currentAlbum,"sortNo",t)},expression:"currentAlbum.sortNo"}})],1),n("el-form-item",{attrs:{label:"相册图片"}},[n("el-upload",{attrs:{"file-list":e.fileList,"auto-upload":!1,action:"",accept:"image/*","on-change":e.debouncedHandleFileChange,"http-request":e.uploadFile,multiple:""}},[n("el-button",{attrs:{type:"primary"}},[e._v("选择图片")])],1),e.albumImages.length?n("div",{staticStyle:{"margin-top":"10px",display:"flex","flex-wrap":"wrap"}},e._l(e.albumImages,(function(t,r){return n("div",{key:r,staticStyle:{position:"relative","margin-right":"10px","margin-bottom":"10px"}},[n("img",{staticStyle:{width:"100px",height:"60px",border:"1px solid #e0e0e0","border-radius":"5px"},attrs:{src:t,alt:"Album Image"}}),n("el-button",{staticStyle:{position:"absolute",top:"0",right:"0","border-radius":"50%",padding:"0",width:"20px",height:"20px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteImage(r)}}},[n("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"12px"}})])],1)})),0):e._e()],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)],1)],1)},a=[],o=n("5530"),i=n("c7eb"),u=n("1da1"),c=(n("4de4"),n("caad"),n("a15b"),n("d81d"),n("a434"),n("b0c0"),n("d3b7"),n("2532"),n("159b"),n("7c15")),l=n("5c96"),s={data:function(){return{listQuery:{name:"",pageNo:1,pageSize:10},albumList:[],total:0,dialogVisible:!1,fileList:[],albumImages:[],currentAlbum:{id:null,name:"",description:"",sortNo:0,picture:""}}},created:function(){this.fetchAlbumList()},methods:{debounce:function(e,t){var n,r=this;return function(){for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];n&&clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}},fetchAlbumList:function(){var e=this;return Object(u["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["l"])({pageNo:e.listQuery.pageNo,pageSize:e.listQuery.pageSize,condition:{name:e.listQuery.name}});case 2:n=t.sent,e.albumList=n.data.records,e.total=n.data.total;case 5:case"end":return t.stop()}}),t)})))()},handleFilter:function(){this.listQuery.pageNo=1,this.fetchAlbumList()},handleCreate:function(){this.currentAlbum={id:null,name:"",description:"",sortNo:0,picture:""},this.fileList=[],this.albumImages=[],this.dialogVisible=!0},handleSave:function(){var e=this;return Object(u["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentAlbum.picture=e.albumImages.join(","),e.currentAlbum.picNum=e.albumImages.length,!e.currentAlbum.id){t.next=7;break}return t.next=5,Object(c["t"])(e.currentAlbum);case 5:t.next=9;break;case 7:return t.next=9,Object(c["a"])(e.currentAlbum);case 9:e.dialogVisible=!1,e.fetchAlbumList();case 11:case"end":return t.stop()}}),t)})))()},handleEdit:function(e){var t=this;return Object(u["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.currentAlbum=Object(o["a"])({},e),t.albumImages=e.picture?e.picture.split(","):[],t.fileList=t.albumImages.map((function(e){return{name:e.split("/").pop(),url:e}})),t.dialogVisible=!0;case 4:case"end":return n.stop()}}),n)})))()},confirmDelete:function(e){var t=this;l["MessageBox"].confirm("确定要删除这个相册吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.handleDelete(e)})).catch((function(){console.log("删除操作取消")}))},handleDelete:function(e){var t=this;return Object(u["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["f"])(e.id);case 2:t.fetchAlbumList();case 3:case"end":return n.stop()}}),n)})))()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.fetchAlbumList()},handleCurrentChange:function(e){this.listQuery.pageNo=e,this.fetchAlbumList()},debouncedHandleFileChange:null,handleFileChange:function(e,t){var n=this,r=t.filter((function(e){return!n.albumImages.some((function(t){return t===e.raw.name}))}));r.forEach(function(){var e=Object(u["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.uploadFile(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},uploadFile:function(e){var t=this;return Object(u["a"])(Object(i["a"])().mark((function n(){var r,a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,!t.fileList.some((function(t){return t.name===e.name}))){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Object(c["z"])(e.raw);case 5:r=n.sent,r.id,a=r.url,t.albumImages.includes(a)||(t.albumImages.push(a),t.fileList.push({name:e.name,url:a})),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),console.error("图片上传失败：",n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()},deleteImage:function(e){this.albumImages.splice(e,1),this.fileList.splice(e,1)}},mounted:function(){this.debouncedHandleFileChange=this.debounce(this.handleFileChange,300)}},d=s,p=n("2877"),m=Object(p["a"])(d,r,a,!1,null,null,null);t["default"]=m.exports},"7c15":function(e,t,n){"use strict";n.d(t,"r",(function(){return u})),n.d(t,"y",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"t",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"s",(function(){return b})),n.d(t,"p",(function(){return f})),n.d(t,"i",(function(){return h})),n.d(t,"o",(function(){return g})),n.d(t,"w",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"n",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"v",(function(){return O})),n.d(t,"h",(function(){return x})),n.d(t,"b",(function(){return C})),n.d(t,"u",(function(){return N})),n.d(t,"g",(function(){return k})),n.d(t,"m",(function(){return A})),n.d(t,"e",(function(){return S})),n.d(t,"x",(function(){return z})),n.d(t,"j",(function(){return I})),n.d(t,"q",(function(){return L})),n.d(t,"A",(function(){return T})),n.d(t,"z",(function(){return F}));var r=n("c7eb"),a=n("1da1"),o=(n("a4d3"),n("e01a"),n("b0c0"),n("b775")),i=n("5f87");function u(e){return Object(o["a"])({url:"/user/page",method:"post",data:{pageNo:e.pageNo||1,pageSize:e.pageSize||10,condition:{title:e.title||"",categoryCode:e.categoryCode||"",status:e.status||"1"}}})}function c(e){return Object(o["a"])({url:"/user",method:"put",data:{userId:e.userId,nickName:e.nickName,avatar:e.avatar,sex:e.sex}})}function l(e){return Object(o["a"])({url:"/user/".concat(e),method:"delete"})}function s(e){return Object(o["a"])({url:"/album/page",method:"post",data:{pageNo:0,pageSize:10,condition:{name:""}}})}function d(e){return Object(o["a"])({url:"/album",method:"post",data:{name:e.name,picNum:e.picNum,sortNo:e.sortNo,description:e.description,picture:e.picture}})}function p(e){return Object(o["a"])({url:"/album",method:"put",data:{id:e.id,name:e.name,picNum:e.picNum,sortNo:e.sortNo,description:e.description,picture:e.picture}})}function m(e){return Object(o["a"])({url:"/album/".concat(e),method:"delete"})}function b(e){return Object(o["a"])({url:"/auth/login",method:"post",data:e})}function f(e){return Object(o["a"])({url:"/news/page",method:"post",data:{pageNo:e.pageNo||1,pageSize:e.pageSize||10,condition:{title:e.title||null,categoryCode:e.categoryCode||null,status:e.status||null}}})}function h(e){return Object(o["a"])({url:"/news/".concat(e),method:"delete"})}function g(e){return Object(o["a"])({url:"/news/".concat(e),method:"get"})}function y(e){return Object(o["a"])({url:"/news",method:"put",data:{id:e.id,title:e.title,categoryCode:e.categoryCode,pictures:e.pictures||[],keyWords:e.keyWords||[],sortNo:e.sortNo||0,productIds:e.productIds||[],status:e.status,releaseTime:e.releaseTime,newsDetail:e.newsDetail}})}function v(e){return Object(o["a"])({url:"/news",method:"post",data:{title:e.title,categoryCode:e.categoryCode,pictures:e.pictures||[],keyWords:e.keyWords||[],sortNo:e.sortNo||0,productIds:e.productIds||[],status:e.status,releaseTime:e.releaseTime,newsDetail:e.newsDetail}})}function w(e){var t,n,r,a;return Object(o["a"])({url:"/category/page",method:"post",data:{pageNo:e.pageNo||1,pageSize:e.pageSize||100,condition:{code:(null===(t=e.condition)||void 0===t?void 0:t.code)||null,name:(null===(n=e.condition)||void 0===n?void 0:n.name)||null,parentCode:(null===(r=e.condition)||void 0===r?void 0:r.parentCode)||null,groupCode:(null===(a=e.condition)||void 0===a?void 0:a.groupCode)||null}}})}function j(e){return Object(o["a"])({url:"/category",method:"post",data:{code:e.code,name:e.name,parentCode:e.parentCode,groupCode:e.groupCode,sortNo:e.sortNo}})}function O(e){return Object(o["a"])({url:"/category",method:"put",data:{id:e.id,code:e.code,name:e.name,parentCode:e.parentCode,groupCode:e.groupCode,sortNo:e.sortNo}})}function x(e){return Object(o["a"])({url:"/category/".concat(e),method:"delete"})}function C(e){return Object(o["a"])({url:"/brand",method:"post",data:{code:e.code,name:e.name,sortNo:e.sortNo}})}function N(e){return Object(o["a"])({url:"/brand",method:"put",data:{id:e.id,code:e.code,name:e.name,sortNo:e.sortNo}})}function k(e){return Object(o["a"])({url:"/brand/".concat(e),method:"delete"})}function A(e){return Object(o["a"])({url:"/brand/page",method:"post",data:{pageNo:e.pageNo||1,pageSize:e.pageSize||10,condition:{title:e.title||"",categoryCode:e.categoryCode||"",status:e.status||"1"}}})}function S(e){return Object(o["a"])({url:"/product",method:"post",data:{categoryCode:e.categoryCode,brandCode:e.brandCode,title:e.title,description:e.description,keyWords:e.keyWords,pictures:e.pictures,productDetail:e.productDetail,sortNo:e.sortNo,releaseTime:e.releaseTime,status:"1"}})}function z(e){return Object(o["a"])({url:"/product",method:"put",data:{id:e.id,categoryCode:e.categoryCode,brandCode:e.brandCode,title:e.title,description:e.description,keyWords:e.keyWords,pictures:e.pictures,productDetail:e.productDetail,sortNo:e.sortNo,releaseTime:e.releaseTime,status:"1"}})}function I(e){return Object(o["a"])({url:"/product/".concat(e),method:"delete"})}function L(e){return Object(o["a"])({url:"/product/page",method:"post",data:{pageNo:e.pageNo,pageSize:e.pageSize,condition:{categoryCode:e.condition.categoryCode,brandCode:e.condition.brandCode,title:e.condition.title,status:e.condition.status||"1"}}})}function T(e){return D.apply(this,arguments)}function D(){return D=Object(a["a"])(Object(r["a"])().mark((function e(t){var n,a,u,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new FormData,n.append("file",t),a=Object(i["a"])(),console.log("Token in uploadFile method:",a),e.next=6,Object(o["a"])({url:"/file/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:n});case 6:if(u=e.sent,!u.success){e.next=12;break}return c=u.data.fileName,e.abrupt("return",{id:c,url:c});case 12:throw console.error("图片上传失败:",u.msg),new Error("图片上传失败");case 14:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function F(e){return _.apply(this,arguments)}function _(){return _=Object(a["a"])(Object(r["a"])().mark((function e(t){var n,a,u,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new FormData,n.append("file",t),a=Object(i["a"])(),console.log("Token in uploadAlbumFile method:",a),e.prev=4,e.next=7,Object(o["a"])({url:"/file/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:n});case 7:if(u=e.sent,console.log("Upload response in album method:",u),!u.success||"0"!==u.code){e.next=14;break}return c=u.data.fileName,e.abrupt("return",{id:c,url:c});case 14:throw console.error("相册图片上传失败:",u.msg),new Error(u.msg||"相册图片上传失败");case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e["catch"](4),console.error("相册上传文件过程中发生错误:",e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[4,18]])}))),_.apply(this,arguments)}}}]);